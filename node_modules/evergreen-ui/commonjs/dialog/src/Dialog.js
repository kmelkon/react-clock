"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf3 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _uiBox = require("ui-box");

var _layers = require("../../layers");

var _typography = require("../../typography");

var _overlay = require("../../overlay");

var _buttons = require("../../buttons");

var _theme = require("../../theme");

var animationEasing = {
  deceleration: "cubic-bezier(0.0, 0.0, 0.2, 1)",
  acceleration: "cubic-bezier(0.4, 0.0, 1, 1)"
};
var ANIMATION_DURATION = 200;

var openAnimation = _uiBox.css.keyframes('openAnimation', {
  from: {
    transform: 'scale(0.8)',
    opacity: 0
  },
  to: {
    transform: 'scale(1)',
    opacity: 1
  }
});

var closeAnimation = _uiBox.css.keyframes('closeAnimation', {
  from: {
    transform: 'scale(1)',
    opacity: 1
  },
  to: {
    transform: 'scale(0.8)',
    opacity: 0
  }
});

var animationStyles = {
  '&[data-state="entering"], &[data-state="entered"]': {
    animation: "".concat(openAnimation, " ").concat(ANIMATION_DURATION, "ms ").concat(animationEasing.deceleration, " both")
  },
  '&[data-state="exiting"]': {
    animation: "".concat(closeAnimation, " ").concat(ANIMATION_DURATION, "ms ").concat(animationEasing.acceleration, " both")
  }
};

var Dialog =
/*#__PURE__*/
function (_React$Component) {
  (0, _inherits2.default)(Dialog, _React$Component);

  function Dialog() {
    var _getPrototypeOf2;

    var _this;

    (0, _classCallCheck2.default)(this, Dialog);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(Dialog)).call.apply(_getPrototypeOf2, [this].concat(args)));
    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), "renderChildren", function (close) {
      var children = _this.props.children;

      if (typeof children === 'function') {
        return children({
          close: close
        });
      }

      if (typeof children === 'string') {
        return _react.default.createElement(_typography.Paragraph, null, children);
      }

      return children;
    });
    return _this;
  }

  (0, _createClass2.default)(Dialog, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          title = _this$props.title,
          width = _this$props.width,
          intent = _this$props.intent,
          isShown = _this$props.isShown,
          topOffset = _this$props.topOffset,
          sideOffset = _this$props.sideOffset,
          hasHeader = _this$props.hasHeader,
          hasFooter = _this$props.hasFooter,
          hasCancel = _this$props.hasCancel,
          onCloseComplete = _this$props.onCloseComplete,
          onOpenComplete = _this$props.onOpenComplete,
          onCancel = _this$props.onCancel,
          onConfirm = _this$props.onConfirm,
          confirmLabel = _this$props.confirmLabel,
          isConfirmLoading = _this$props.isConfirmLoading,
          isConfirmDisabled = _this$props.isConfirmDisabled,
          cancelLabel = _this$props.cancelLabel,
          shouldCloseOnOverlayClick = _this$props.shouldCloseOnOverlayClick,
          shouldCloseOnEscapePress = _this$props.shouldCloseOnEscapePress,
          containerProps = _this$props.containerProps,
          contentContainerProps = _this$props.contentContainerProps,
          minHeightContent = _this$props.minHeightContent;
      var sideOffsetWithUnit = Number.isInteger(sideOffset) ? "".concat(sideOffset, "px") : sideOffset;
      var maxWidth = "calc(100% - ".concat(sideOffsetWithUnit, " * 2)");
      var topOffsetWithUnit = Number.isInteger(topOffset) ? "".concat(topOffset, "px") : topOffset;
      var maxHeight = "calc(100% - ".concat(topOffsetWithUnit, " * 2)");
      return _react.default.createElement(_overlay.Overlay, {
        isShown: isShown,
        shouldCloseOnClick: shouldCloseOnOverlayClick,
        shouldCloseOnEscapePress: shouldCloseOnEscapePress,
        onExited: onCloseComplete,
        onEntered: onOpenComplete,
        containerProps: {
          display: 'flex',
          alignItems: 'flex-start',
          justifyContent: 'center'
        }
      }, function (_ref) {
        var state = _ref.state,
            close = _ref.close;
        return _react.default.createElement(_layers.Pane, (0, _extends2.default)({
          role: "dialog",
          backgroundColor: "white",
          elevation: 4,
          borderRadius: 8,
          width: width,
          maxWidth: maxWidth,
          maxHeight: maxHeight,
          marginX: sideOffsetWithUnit,
          marginY: topOffsetWithUnit,
          display: "flex",
          flexDirection: "column",
          css: animationStyles,
          "data-state": state
        }, containerProps), hasHeader && _react.default.createElement(_layers.Pane, {
          padding: 16,
          flexShrink: 0,
          borderBottom: "muted",
          display: "flex",
          alignItems: "center"
        }, _react.default.createElement(_typography.Heading, {
          is: "h4",
          size: 600,
          flex: "1"
        }, title), _react.default.createElement(_buttons.IconButton, {
          appearance: "minimal",
          icon: "cross",
          onClick: function onClick() {
            return onCancel(close);
          }
        })), _react.default.createElement(_layers.Pane, (0, _extends2.default)({
          "data-state": state,
          display: "flex",
          overflow: "auto",
          padding: 16,
          flexDirection: "column",
          minHeight: minHeightContent
        }, contentContainerProps), _react.default.createElement(_layers.Pane, null, _this2.renderChildren(close))), hasFooter && _react.default.createElement(_layers.Pane, {
          borderTop: "muted",
          clearfix: true
        }, _react.default.createElement(_layers.Pane, {
          padding: 16,
          float: "right"
        }, hasCancel && _react.default.createElement(_buttons.Button, {
          tabIndex: 0,
          onClick: function onClick() {
            return onCancel(close);
          }
        }, cancelLabel), _react.default.createElement(_buttons.Button, {
          tabIndex: 0,
          marginLeft: 8,
          appearance: "primary",
          isLoading: isConfirmLoading,
          disabled: isConfirmDisabled,
          onClick: function onClick() {
            return onConfirm(close);
          },
          intent: intent
        }, confirmLabel))));
      });
    }
  }]);
  return Dialog;
}(_react.default.Component);

Dialog.displayName = "Dialog";
(0, _defineProperty2.default)(Dialog, "propTypes", {
  /**
   * Children can be a string, node or a function accepting `({ close })`.
   * When passing a string, <Paragraph /> is used to wrap the string.
   */
  children: _propTypes.default.oneOfType([_propTypes.default.node, _propTypes.default.func]).isRequired,

  /**
   * The intent of the Dialog. Used for the button.
   */
  intent: _propTypes.default.oneOf(['none', 'success', 'warning', 'danger']).isRequired,

  /**
   * When true, the dialog is shown.
   */
  isShown: _propTypes.default.bool,

  /**
   * Title of the Dialog. Titles should use Title Case.
   */
  title: _propTypes.default.node,

  /**
   * When true, the header with the title and close icon button is shown.
   */
  hasHeader: _propTypes.default.bool,

  /**
   * When true, the footer with the cancel and confirm button is shown.
   */
  hasFooter: _propTypes.default.bool,

  /**
   * When true, the cancel button is shown.
   */
  hasCancel: _propTypes.default.bool,

  /**
   * Function that will be called when the exit transition is complete.
   */
  onCloseComplete: _propTypes.default.func,

  /**
   * Function that will be called when the enter transition is complete.
   */
  onOpenComplete: _propTypes.default.func,

  /**
   * Function that will be called when the confirm button is clicked.
   * This does not close the Dialog. A close function will be passed
   * as a paramater you can use to close the dialog.
   *
   * `onConfirm={(close) => close()}`
   */
  onConfirm: _propTypes.default.func,

  /**
   * Label of the confirm button.
   */
  confirmLabel: _propTypes.default.string,

  /**
   * When true, the confirm button is set to loading.
   */
  isConfirmLoading: _propTypes.default.bool,

  /**
   * When true, the confirm button is set to disabled.
   */
  isConfirmDisabled: _propTypes.default.bool,

  /**
   * Function that will be called when the cancel button is clicked.
   * This closes the Dialog by default.
   *
   * `onCancel={(close) => close()}`
   */
  onCancel: _propTypes.default.func,

  /**
   * Label of the cancel button.
   */
  cancelLabel: _propTypes.default.string,

  /**
   * Boolean indicating if clicking the overlay should close the overlay.
   */
  shouldCloseOnOverlayClick: _propTypes.default.bool,

  /**
   * Boolean indicating if pressing the esc key should close the overlay.
   */
  shouldCloseOnEscapePress: _propTypes.default.bool,

  /**
   * Width of the Dialog.
   */
  width: _propTypes.default.oneOfType([_propTypes.default.string, _propTypes.default.number]),

  /**
   * The space above the dialog.
   * This offset is also used at the bottom when there is not enough vertical
   * space available on screen â€” and the dialog scrolls internally.
   */
  topOffset: _propTypes.default.oneOfType([_propTypes.default.string, _propTypes.default.number]),

  /**
   * The space on the left/right sides of the dialog when there isn't enough
   * horizontal space available on screen.
   */
  sideOffset: _propTypes.default.oneOfType([_propTypes.default.string, _propTypes.default.number]),

  /**
   * The min height of the body content.
   * Makes it less weird when only showing little content.
   */
  minHeightContent: _propTypes.default.oneOfType([_propTypes.default.string, _propTypes.default.number]),

  /**
   * Props that are passed to the dialog container.
   */
  containerProps: _propTypes.default.object,

  /**
   * Props that are passed to the content container.
   */
  contentContainerProps: _propTypes.default.object
});
(0, _defineProperty2.default)(Dialog, "defaultProps", {
  isShown: false,
  hasHeader: true,
  hasFooter: true,
  hasCancel: true,
  intent: 'none',
  width: 560,
  topOffset: '12vmin',
  sideOffset: '16px',
  minHeightContent: 80,
  confirmLabel: 'Confirm',
  isConfirmLoading: false,
  isConfirmDisabled: false,
  cancelLabel: 'Cancel',
  shouldCloseOnOverlayClick: true,
  shouldCloseOnEscapePress: true,
  onCancel: function onCancel(close) {
    return close();
  },
  onConfirm: function onConfirm(close) {
    return close();
  }
});

var _default = (0, _theme.withTheme)(Dialog);

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9kaWFsb2cvc3JjL0RpYWxvZy5qcyJdLCJuYW1lcyI6WyJhbmltYXRpb25FYXNpbmciLCJkZWNlbGVyYXRpb24iLCJhY2NlbGVyYXRpb24iLCJBTklNQVRJT05fRFVSQVRJT04iLCJvcGVuQW5pbWF0aW9uIiwiY3NzIiwia2V5ZnJhbWVzIiwiZnJvbSIsInRyYW5zZm9ybSIsIm9wYWNpdHkiLCJ0byIsImNsb3NlQW5pbWF0aW9uIiwiYW5pbWF0aW9uU3R5bGVzIiwiYW5pbWF0aW9uIiwiRGlhbG9nIiwiY2xvc2UiLCJjaGlsZHJlbiIsInByb3BzIiwidGl0bGUiLCJ3aWR0aCIsImludGVudCIsImlzU2hvd24iLCJ0b3BPZmZzZXQiLCJzaWRlT2Zmc2V0IiwiaGFzSGVhZGVyIiwiaGFzRm9vdGVyIiwiaGFzQ2FuY2VsIiwib25DbG9zZUNvbXBsZXRlIiwib25PcGVuQ29tcGxldGUiLCJvbkNhbmNlbCIsIm9uQ29uZmlybSIsImNvbmZpcm1MYWJlbCIsImlzQ29uZmlybUxvYWRpbmciLCJpc0NvbmZpcm1EaXNhYmxlZCIsImNhbmNlbExhYmVsIiwic2hvdWxkQ2xvc2VPbk92ZXJsYXlDbGljayIsInNob3VsZENsb3NlT25Fc2NhcGVQcmVzcyIsImNvbnRhaW5lclByb3BzIiwiY29udGVudENvbnRhaW5lclByb3BzIiwibWluSGVpZ2h0Q29udGVudCIsInNpZGVPZmZzZXRXaXRoVW5pdCIsIk51bWJlciIsImlzSW50ZWdlciIsIm1heFdpZHRoIiwidG9wT2Zmc2V0V2l0aFVuaXQiLCJtYXhIZWlnaHQiLCJkaXNwbGF5IiwiYWxpZ25JdGVtcyIsImp1c3RpZnlDb250ZW50Iiwic3RhdGUiLCJyZW5kZXJDaGlsZHJlbiIsIlJlYWN0IiwiQ29tcG9uZW50IiwiUHJvcFR5cGVzIiwib25lT2ZUeXBlIiwibm9kZSIsImZ1bmMiLCJpc1JlcXVpcmVkIiwib25lT2YiLCJib29sIiwic3RyaW5nIiwibnVtYmVyIiwib2JqZWN0Il0sIm1hcHBpbmdz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QUdBeEIsRUFBQUEsY0FBYyxFQUFFZ0IsbUJBQVVTLE1BMUhUOztBQTRIakI7OztBQUdBeEIsRUFBQUEscUJBQXFCLEVBQUVlLG1CQUFVUztBQS9IaEIsQzs4QkFEZmhELE0sa0JBbUlrQjtBQUNwQk8sRUFBQUEsT0FBTyxFQUFFLEtBRFc7QUFFcEJHLEVBQUFBLFNBQVMsRUFBRSxJQUZTO0FBR3BCQyxFQUFBQSxTQUFTLEVBQUUsSUFIUztBQUlwQkMsRUFBQUEsU0FBUyxFQUFFLElBSlM7QUFLcEJOLEVBQUFBLE1BQU0sRUFBRSxNQUxZO0FBTXBCRCxFQUFBQSxLQUFLLEVBQUUsR0FOYTtBQU9wQkcsRUFBQUEsU0FBUyxFQUFFLFFBUFM7QUFRcEJDLEVBQUFBLFVBQVUsRUFBRSxNQVJRO0FBU3BCZ0IsRUFBQUEsZ0JBQWdCLEVBQUUsRUFURTtBQVVwQlIsRUFBQUEsWUFBWSxFQUFFLFNBVk07QUFXcEJDLEVBQUFBLGdCQUFnQixFQUFFLEtBWEU7QUFZcEJDLEVBQUFBLGlCQUFpQixFQUFFLEtBWkM7QUFhcEJDLEVBQUFBLFdBQVcsRUFBRSxRQWJPO0FBY3BCQyxFQUFBQSx5QkFBeUIsRUFBRSxJQWRQO0FBZXBCQyxFQUFBQSx3QkFBd0IsRUFBRSxJQWZOO0FBZ0JwQlAsRUFBQUEsUUFBUSxFQUFFLGtCQUFBZCxLQUFLO0FBQUEsV0FBSUEsS0FBSyxFQUFUO0FBQUEsR0FoQks7QUFpQnBCZSxFQUFBQSxTQUFTLEVBQUUsbUJBQUFmLEtBQUs7QUFBQSxXQUFJQSxLQUFLLEVBQVQ7QUFBQTtBQWpCSSxDOztlQWdLVCxzQkFBVUQsTUFBVixDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0J1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJ1xuaW1wb3J0IHsgY3NzIH0gZnJvbSAndWktYm94J1xuaW1wb3J0IHsgUGFuZSB9IGZyb20gJy4uLy4uL2xheWVycydcbmltcG9ydCB7IFBhcmFncmFwaCwgSGVhZGluZyB9IGZyb20gJy4uLy4uL3R5cG9ncmFwaHknXG5pbXBvcnQgeyBPdmVybGF5IH0gZnJvbSAnLi4vLi4vb3ZlcmxheSdcbmltcG9ydCB7IEJ1dHRvbiwgSWNvbkJ1dHRvbiB9IGZyb20gJy4uLy4uL2J1dHRvbnMnXG5pbXBvcnQgeyB3aXRoVGhlbWUgfSBmcm9tICcuLi8uLi90aGVtZSdcblxuY29uc3QgYW5pbWF0aW9uRWFzaW5nID0ge1xuICBkZWNlbGVyYXRpb246IGBjdWJpYy1iZXppZXIoMC4wLCAwLjAsIDAuMiwgMSlgLFxuICBhY2NlbGVyYXRpb246IGBjdWJpYy1iZXppZXIoMC40LCAwLjAsIDEsIDEpYFxufVxuXG5jb25zdCBBTklNQVRJT05fRFVSQVRJT04gPSAyMDBcblxuY29uc3Qgb3BlbkFuaW1hdGlvbiA9IGNzcy5rZXlmcmFtZXMoJ29wZW5BbmltYXRpb24nLCB7XG4gIGZyb206IHtcbiAgICB0cmFuc2Zvcm06ICdzY2FsZSgwLjgpJyxcbiAgICBvcGFjaXR5OiAwXG4gIH0sXG4gIHRvOiB7XG4gICAgdHJhbnNmb3JtOiAnc2NhbGUoMSknLFxuICAgIG9wYWNpdHk6IDFcbiAgfVxufSlcblxuY29uc3QgY2xvc2VBbmltYXRpb24gPSBjc3Mua2V5ZnJhbWVzKCdjbG9zZUFuaW1hdGlvbicsIHtcbiAgZnJvbToge1xuICAgIHRyYW5zZm9ybTogJ3NjYWxlKDEpJyxcbiAgICBvcGFjaXR5OiAxXG4gIH0sXG4gIHRvOiB7XG4gICAgdHJhbnNmb3JtOiAnc2NhbGUoMC44KScsXG4gICAgb3BhY2l0eTogMFxuICB9XG59KVxuXG5jb25zdCBhbmltYXRpb25TdHlsZXMgPSB7XG4gICcmW2RhdGEtc3RhdGU9XCJlbnRlcmluZ1wiXSwgJltkYXRhLXN0YXRlPVwiZW50ZXJlZFwiXSc6IHtcbiAgICBhbmltYXRpb246IGAke29wZW5BbmltYXRpb259ICR7QU5JTUFUSU9OX0RVUkFUSU9OfW1zICR7XG4gICAgICBhbmltYXRpb25FYXNpbmcuZGVjZWxlcmF0aW9uXG4gICAgfSBib3RoYFxuICB9LFxuICAnJltkYXRhLXN0YXRlPVwiZXhpdGluZ1wiXSc6IHtcbiAgICBhbmltYXRpb246IGAke2Nsb3NlQW5pbWF0aW9ufSAke0FOSU1BVElPTl9EVVJBVElPTn1tcyAke1xuICAgICAgYW5pbWF0aW9uRWFzaW5nLmFjY2VsZXJhdGlvblxuICAgIH0gYm90aGBcbiAgfVxufVxuXG5jbGFzcyBEaWFsb2cgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIC8qKlxuICAgICAqIENoaWxkcmVuIGNhbiBiZSBhIHN0cmluZywgbm9kZSBvciBhIGZ1bmN0aW9uIGFjY2VwdGluZyBgKHsgY2xvc2UgfSlgLlxuICAgICAqIFdoZW4gcGFzc2luZyBhIHN0cmluZywgPFBhcmFncmFwaCAvPiBpcyB1c2VkIHRvIHdyYXAgdGhlIHN0cmluZy5cbiAgICAgKi9cbiAgICBjaGlsZHJlbjogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLm5vZGUsIFByb3BUeXBlcy5mdW5jXSkuaXNSZXF1aXJlZCxcblxuICAgIC8qKlxuICAgICAqIFRoZSBpbnRlbnQgb2YgdGhlIERpYWxvZy4gVXNlZCBmb3IgdGhlIGJ1dHRvbi5cbiAgICAgKi9cbiAgICBpbnRlbnQ6IFByb3BUeXBlcy5vbmVPZihbJ25vbmUnLCAnc3VjY2VzcycsICd3YXJuaW5nJywgJ2RhbmdlciddKVxuICAgICAgLmlzUmVxdWlyZWQsXG5cbiAgICAvKipcbiAgICAgKiBXaGVuIHRydWUsIHRoZSBkaWFsb2cgaXMgc2hvd24uXG4gICAgICovXG4gICAgaXNTaG93bjogUHJvcFR5cGVzLmJvb2wsXG5cbiAgICAvKipcbiAgICAgKiBUaXRsZSBvZiB0aGUgRGlhbG9nLiBUaXRsZXMgc2hvdWxkIHVzZSBUaXRsZSBDYXNlLlxuICAgICAqL1xuICAgIHRpdGxlOiBQcm9wVHlwZXMubm9kZSxcblxuICAgIC8qKlxuICAgICAqIFdoZW4gdHJ1ZSwgdGhlIGhlYWRlciB3aXRoIHRoZSB0aXRsZSBhbmQgY2xvc2UgaWNvbiBidXR0b24gaXMgc2hvd24uXG4gICAgICovXG4gICAgaGFzSGVhZGVyOiBQcm9wVHlwZXMuYm9vbCxcblxuICAgIC8qKlxuICAgICAqIFdoZW4gdHJ1ZSwgdGhlIGZvb3RlciB3aXRoIHRoZSBjYW5jZWwgYW5kIGNvbmZpcm0gYnV0dG9uIGlzIHNob3duLlxuICAgICAqL1xuICAgIGhhc0Zvb3RlcjogUHJvcFR5cGVzLmJvb2wsXG5cbiAgICAvKipcbiAgICAgKiBXaGVuIHRydWUsIHRoZSBjYW5jZWwgYnV0dG9uIGlzIHNob3duLlxuICAgICAqL1xuICAgIGhhc0NhbmNlbDogUHJvcFR5cGVzLmJvb2wsXG5cbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIGV4aXQgdHJhbnNpdGlvbiBpcyBjb21wbGV0ZS5cbiAgICAgKi9cbiAgICBvbkNsb3NlQ29tcGxldGU6IFByb3BUeXBlcy5mdW5jLFxuXG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBlbnRlciB0cmFuc2l0aW9uIGlzIGNvbXBsZXRlLlxuICAgICAqL1xuICAgIG9uT3BlbkNvbXBsZXRlOiBQcm9wVHlwZXMuZnVuYyxcblxuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgY29uZmlybSBidXR0b24gaXMgY2xpY2tlZC5cbiAgICAgKiBUaGlzIGRvZXMgbm90IGNsb3NlIHRoZSBEaWFsb2cuIEEgY2xvc2UgZnVuY3Rpb24gd2lsbCBiZSBwYXNzZWRcbiAgICAgKiBhcyBhIHBhcmFtYXRlciB5b3UgY2FuIHVzZSB0byBjbG9zZSB0aGUgZGlhbG9nLlxuICAgICAqXG4gICAgICogYG9uQ29uZmlybT17KGNsb3NlKSA9PiBjbG9zZSgpfWBcbiAgICAgKi9cbiAgICBvbkNvbmZpcm06IFByb3BUeXBlcy5mdW5jLFxuXG4gICAgLyoqXG4gICAgICogTGFiZWwgb2YgdGhlIGNvbmZpcm0gYnV0dG9uLlxuICAgICAqL1xuICAgIGNvbmZpcm1MYWJlbDogUHJvcFR5cGVzLnN0cmluZyxcblxuICAgIC8qKlxuICAgICAqIFdoZW4gdHJ1ZSwgdGhlIGNvbmZpcm0gYnV0dG9uIGlzIHNldCB0byBsb2FkaW5nLlxuICAgICAqL1xuICAgIGlzQ29uZmlybUxvYWRpbmc6IFByb3BUeXBlcy5ib29sLFxuXG4gICAgLyoqXG4gICAgICogV2hlbiB0cnVlLCB0aGUgY29uZmlybSBidXR0b24gaXMgc2V0IHRvIGRpc2FibGVkLlxuICAgICAqL1xuICAgIGlzQ29uZmlybURpc2FibGVkOiBQcm9wVHlwZXMuYm9vbCxcblxuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgY2FuY2VsIGJ1dHRvbiBpcyBjbGlja2VkLlxuICAgICAqIFRoaXMgY2xvc2VzIHRoZSBEaWFsb2cgYnkgZGVmYXVsdC5cbiAgICAgKlxuICAgICAqIGBvbkNhbmNlbD17KGNsb3NlKSA9PiBjbG9zZSgpfWBcbiAgICAgKi9cbiAgICBvbkNhbmNlbDogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgICAvKipcbiAgICAgKiBMYWJlbCBvZiB0aGUgY2FuY2VsIGJ1dHRvbi5cbiAgICAgKi9cbiAgICBjYW5jZWxMYWJlbDogUHJvcFR5cGVzLnN0cmluZyxcblxuICAgIC8qKlxuICAgICAqIEJvb2xlYW4gaW5kaWNhdGluZyBpZiBjbGlja2luZyB0aGUgb3ZlcmxheSBzaG91bGQgY2xvc2UgdGhlIG92ZXJsYXkuXG4gICAgICovXG4gICAgc2hvdWxkQ2xvc2VPbk92ZXJsYXlDbGljazogUHJvcFR5cGVzLmJvb2wsXG5cbiAgICAvKipcbiAgICAgKiBCb29sZWFuIGluZGljYXRpbmcgaWYgcHJlc3NpbmcgdGhlIGVzYyBrZXkgc2hvdWxkIGNsb3NlIHRoZSBvdmVybGF5LlxuICAgICAqL1xuICAgIHNob3VsZENsb3NlT25Fc2NhcGVQcmVzczogUHJvcFR5cGVzLmJvb2wsXG5cbiAgICAvKipcbiAgICAgKiBXaWR0aCBvZiB0aGUgRGlhbG9nLlxuICAgICAqL1xuICAgIHdpZHRoOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuc3RyaW5nLCBQcm9wVHlwZXMubnVtYmVyXSksXG5cbiAgICAvKipcbiAgICAgKiBUaGUgc3BhY2UgYWJvdmUgdGhlIGRpYWxvZy5cbiAgICAgKiBUaGlzIG9mZnNldCBpcyBhbHNvIHVzZWQgYXQgdGhlIGJvdHRvbSB3aGVuIHRoZXJlIGlzIG5vdCBlbm91Z2ggdmVydGljYWxcbiAgICAgKiBzcGFjZSBhdmFpbGFibGUgb24gc2NyZWVuIOKAlCBhbmQgdGhlIGRpYWxvZyBzY3JvbGxzIGludGVybmFsbHkuXG4gICAgICovXG4gICAgdG9wT2Zmc2V0OiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuc3RyaW5nLCBQcm9wVHlwZXMubnVtYmVyXSksXG5cbiAgICAvKipcbiAgICAgKiBUaGUgc3BhY2Ugb24gdGhlIGxlZnQvcmlnaHQgc2lkZXMgb2YgdGhlIGRpYWxvZyB3aGVuIHRoZXJlIGlzbid0IGVub3VnaFxuICAgICAqIGhvcml6b250YWwgc3BhY2UgYXZhaWxhYmxlIG9uIHNjcmVlbi5cbiAgICAgKi9cbiAgICBzaWRlT2Zmc2V0OiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuc3RyaW5nLCBQcm9wVHlwZXMubnVtYmVyXSksXG5cbiAgICAvKipcbiAgICAgKiBUaGUgbWluIGhlaWdodCBvZiB0aGUgYm9keSBjb250ZW50LlxuICAgICAqIE1ha2VzIGl0IGxlc3Mgd2VpcmQgd2hlbiBvbmx5IHNob3dpbmcgbGl0dGxlIGNvbnRlbnQuXG4gICAgICovXG4gICAgbWluSGVpZ2h0Q29udGVudDogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLnN0cmluZywgUHJvcFR5cGVzLm51bWJlcl0pLFxuXG4gICAgLyoqXG4gICAgICogUHJvcHMgdGhhdCBhcmUgcGFzc2VkIHRvIHRoZSBkaWFsb2cgY29udGFpbmVyLlxuICAgICAqL1xuICAgIGNvbnRhaW5lclByb3BzOiBQcm9wVHlwZXMub2JqZWN0LFxuXG4gICAgLyoqXG4gICAgICogUHJvcHMgdGhhdCBhcmUgcGFzc2VkIHRvIHRoZSBjb250ZW50IGNvbnRhaW5lci5cbiAgICAgKi9cbiAgICBjb250ZW50Q29udGFpbmVyUHJvcHM6IFByb3BUeXBlcy5vYmplY3RcbiAgfVxuXG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgaXNTaG93bjogZmFsc2UsXG4gICAgaGFzSGVhZGVyOiB0cnVlLFxuICAgIGhhc0Zvb3RlcjogdHJ1ZSxcbiAgICBoYXNDYW5jZWw6IHRydWUsXG4gICAgaW50ZW50OiAnbm9uZScsXG4gICAgd2lkdGg6IDU2MCxcbiAgICB0b3BPZmZzZXQ6ICcxMnZtaW4nLFxuICAgIHNpZGVPZmZzZXQ6ICcxNnB4JyxcbiAgICBtaW5IZWlnaHRDb250ZW50OiA4MCxcbiAgICBjb25maXJtTGFiZWw6ICdDb25maXJtJyxcbiAgICBpc0NvbmZpcm1Mb2FkaW5nOiBmYWxzZSxcbiAgICBpc0NvbmZpcm1EaXNhYmxlZDogZmFsc2UsXG4gICAgY2FuY2VsTGFiZWw6ICdDYW5jZWwnLFxuICAgIHNob3VsZENsb3NlT25PdmVybGF5Q2xpY2s6IHRydWUsXG4gICAgc2hvdWxkQ2xvc2VPbkVzY2FwZVByZXNzOiB0cnVlLFxuICAgIG9uQ2FuY2VsOiBjbG9zZSA9PiBjbG9zZSgpLFxuICAgIG9uQ29uZmlybTogY2xvc2UgPT4gY2xvc2UoKVxuICB9XG5cbiAgcmVuZGVyQ2hpbGRyZW4gPSBjbG9zZSA9PiB7XG4gICAgY29uc3QgeyBjaGlsZHJlbiB9ID0gdGhpcy5wcm9wc1xuXG4gICAgaWYgKHR5cGVvZiBjaGlsZHJlbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmV0dXJuIGNoaWxkcmVuKHsgY2xvc2UgfSlcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBjaGlsZHJlbiA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHJldHVybiA8UGFyYWdyYXBoPntjaGlsZHJlbn08L1BhcmFncmFwaD5cbiAgICB9XG4gICAgcmV0dXJuIGNoaWxkcmVuXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge1xuICAgICAgdGl0bGUsXG4gICAgICB3aWR0aCxcbiAgICAgIGludGVudCxcbiAgICAgIGlzU2hvd24sXG4gICAgICB0b3BPZmZzZXQsXG4gICAgICBzaWRlT2Zmc2V0LFxuICAgICAgaGFzSGVhZGVyLFxuICAgICAgaGFzRm9vdGVyLFxuICAgICAgaGFzQ2FuY2VsLFxuICAgICAgb25DbG9zZUNvbXBsZXRlLFxuICAgICAgb25PcGVuQ29tcGxldGUsXG4gICAgICBvbkNhbmNlbCxcbiAgICAgIG9uQ29uZmlybSxcbiAgICAgIGNvbmZpcm1MYWJlbCxcbiAgICAgIGlzQ29uZmlybUxvYWRpbmcsXG4gICAgICBpc0NvbmZpcm1EaXNhYmxlZCxcbiAgICAgIGNhbmNlbExhYmVsLFxuICAgICAgc2hvdWxkQ2xvc2VPbk92ZXJsYXlDbGljayxcbiAgICAgIHNob3VsZENsb3NlT25Fc2NhcGVQcmVzcyxcbiAgICAgIGNvbnRhaW5lclByb3BzLFxuICAgICAgY29udGVudENvbnRhaW5lclByb3BzLFxuICAgICAgbWluSGVpZ2h0Q29udGVudFxuICAgIH0gPSB0aGlzLnByb3BzXG5cbiAgICBjb25zdCBzaWRlT2Zmc2V0V2l0aFVuaXQgPSBOdW1iZXIuaXNJbnRlZ2VyKHNpZGVPZmZzZXQpXG4gICAgICA/IGAke3NpZGVPZmZzZXR9cHhgXG4gICAgICA6IHNpZGVPZmZzZXRcbiAgICBjb25zdCBtYXhXaWR0aCA9IGBjYWxjKDEwMCUgLSAke3NpZGVPZmZzZXRXaXRoVW5pdH0gKiAyKWBcblxuICAgIGNvbnN0IHRvcE9mZnNldFdpdGhVbml0ID0gTnVtYmVyLmlzSW50ZWdlcih0b3BPZmZzZXQpXG4gICAgICA/IGAke3RvcE9mZnNldH1weGBcbiAgICAgIDogdG9wT2Zmc2V0XG4gICAgY29uc3QgbWF4SGVpZ2h0ID0gYGNhbGMoMTAwJSAtICR7dG9wT2Zmc2V0V2l0aFVuaXR9ICogMilgXG5cbiAgICByZXR1cm4gKFxuICAgICAgPE92ZXJsYXlcbiAgICAgICAgaXNTaG93bj17aXNTaG93bn1cbiAgICAgICAgc2hvdWxkQ2xvc2VPbkNsaWNrPXtzaG91bGRDbG9zZU9uT3ZlcmxheUNsaWNrfVxuICAgICAgICBzaG91bGRDbG9zZU9uRXNjYXBlUHJlc3M9e3Nob3VsZENsb3NlT25Fc2NhcGVQcmVzc31cbiAgICAgICAgb25FeGl0ZWQ9e29uQ2xvc2VDb21wbGV0ZX1cbiAgICAgICAgb25FbnRlcmVkPXtvbk9wZW5Db21wbGV0ZX1cbiAgICAgICAgY29udGFpbmVyUHJvcHM9e3tcbiAgICAgICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICAgICAgYWxpZ25JdGVtczogJ2ZsZXgtc3RhcnQnLFxuICAgICAgICAgIGp1c3RpZnlDb250ZW50OiAnY2VudGVyJ1xuICAgICAgICB9fVxuICAgICAgPlxuICAgICAgICB7KHsgc3RhdGUsIGNsb3NlIH0pID0+IChcbiAgICAgICAgICA8UGFuZVxuICAgICAgICAgICAgcm9sZT1cImRpYWxvZ1wiXG4gICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I9XCJ3aGl0ZVwiXG4gICAgICAgICAgICBlbGV2YXRpb249ezR9XG4gICAgICAgICAgICBib3JkZXJSYWRpdXM9ezh9XG4gICAgICAgICAgICB3aWR0aD17d2lkdGh9XG4gICAgICAgICAgICBtYXhXaWR0aD17bWF4V2lkdGh9XG4gICAgICAgICAgICBtYXhIZWlnaHQ9e21heEhlaWdodH1cbiAgICAgICAgICAgIG1hcmdpblg9e3NpZGVPZmZzZXRXaXRoVW5pdH1cbiAgICAgICAgICAgIG1hcmdpblk9e3RvcE9mZnNldFdpdGhVbml0fVxuICAgICAgICAgICAgZGlzcGxheT1cImZsZXhcIlxuICAgICAgICAgICAgZmxleERpcmVjdGlvbj1cImNvbHVtblwiXG4gICAgICAgICAgICBjc3M9e2FuaW1hdGlvblN0eWxlc31cbiAgICAgICAgICAgIGRhdGEtc3RhdGU9e3N0YXRlfVxuICAgICAgICAgICAgey4uLmNvbnRhaW5lclByb3BzfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIHtoYXNIZWFkZXIgJiYgKFxuICAgICAgICAgICAgICA8UGFuZVxuICAgICAgICAgICAgICAgIHBhZGRpbmc9ezE2fVxuICAgICAgICAgICAgICAgIGZsZXhTaHJpbms9ezB9XG4gICAgICAgICAgICAgICAgYm9yZGVyQm90dG9tPVwibXV0ZWRcIlxuICAgICAgICAgICAgICAgIGRpc3BsYXk9XCJmbGV4XCJcbiAgICAgICAgICAgICAgICBhbGlnbkl0ZW1zPVwiY2VudGVyXCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxIZWFkaW5nIGlzPVwiaDRcIiBzaXplPXs2MDB9IGZsZXg9XCIxXCI+XG4gICAgICAgICAgICAgICAgICB7dGl0bGV9XG4gICAgICAgICAgICAgICAgPC9IZWFkaW5nPlxuICAgICAgICAgICAgICAgIDxJY29uQnV0dG9uXG4gICAgICAgICAgICAgICAgICBhcHBlYXJhbmNlPVwibWluaW1hbFwiXG4gICAgICAgICAgICAgICAgICBpY29uPVwiY3Jvc3NcIlxuICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gb25DYW5jZWwoY2xvc2UpfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDwvUGFuZT5cbiAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgIDxQYW5lXG4gICAgICAgICAgICAgIGRhdGEtc3RhdGU9e3N0YXRlfVxuICAgICAgICAgICAgICBkaXNwbGF5PVwiZmxleFwiXG4gICAgICAgICAgICAgIG92ZXJmbG93PVwiYXV0b1wiXG4gICAgICAgICAgICAgIHBhZGRpbmc9ezE2fVxuICAgICAgICAgICAgICBmbGV4RGlyZWN0aW9uPVwiY29sdW1uXCJcbiAgICAgICAgICAgICAgbWluSGVpZ2h0PXttaW5IZWlnaHRDb250ZW50fVxuICAgICAgICAgICAgICB7Li4uY29udGVudENvbnRhaW5lclByb3BzfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8UGFuZT57dGhpcy5yZW5kZXJDaGlsZHJlbihjbG9zZSl9PC9QYW5lPlxuICAgICAgICAgICAgPC9QYW5lPlxuXG4gICAgICAgICAgICB7aGFzRm9vdGVyICYmIChcbiAgICAgICAgICAgICAgPFBhbmUgYm9yZGVyVG9wPVwibXV0ZWRcIiBjbGVhcmZpeD5cbiAgICAgICAgICAgICAgICA8UGFuZSBwYWRkaW5nPXsxNn0gZmxvYXQ9XCJyaWdodFwiPlxuICAgICAgICAgICAgICAgICAgey8qIENhbmNlbCBzaG91bGQgYmUgZmlyc3QgdG8gbWFrZSBzdXJlIGZvY3VzIGdldHMgb24gaXQgZmlyc3QuICovfVxuICAgICAgICAgICAgICAgICAge2hhc0NhbmNlbCAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDxCdXR0b24gdGFiSW5kZXg9ezB9IG9uQ2xpY2s9eygpID0+IG9uQ2FuY2VsKGNsb3NlKX0+XG4gICAgICAgICAgICAgICAgICAgICAge2NhbmNlbExhYmVsfVxuICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgdGFiSW5kZXg9ezB9XG4gICAgICAgICAgICAgICAgICAgIG1hcmdpbkxlZnQ9ezh9XG4gICAgICAgICAgICAgICAgICAgIGFwcGVhcmFuY2U9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgaXNMb2FkaW5nPXtpc0NvbmZpcm1Mb2FkaW5nfVxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17aXNDb25maXJtRGlzYWJsZWR9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IG9uQ29uZmlybShjbG9zZSl9XG4gICAgICAgICAgICAgICAgICAgIGludGVudD17aW50ZW50fVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICB7Y29uZmlybUxhYmVsfVxuICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgPC9QYW5lPlxuICAgICAgICAgICAgICA8L1BhbmU+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvUGFuZT5cbiAgICAgICAgKX1cbiAgICAgIDwvT3ZlcmxheT5cbiAgICApXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgd2l0aFRoZW1lKERpYWxvZylcbiJdfQ==